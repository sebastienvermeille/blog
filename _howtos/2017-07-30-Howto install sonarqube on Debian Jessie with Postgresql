---
layout: howto
title: "[SonarQube] Comment installer sonarqube sur Debian Jessie avec PostgreSQL"
description: Un petit guide sur l'installation de sonarqube pour debian avec postgresql
date: 2017-07-31 00:00
cover: ../media/cover/sonarqube.png
lang: "fr"
published: true
comments: true
github: 
tags: ['debian', 'sonar', 'sonarqube', 'postgresql']
---

# Les pré-requis pour suivre ce tutorial
* Avoir un serveur sous Debian 8 (Jessie)
* Avoir installé wget (sudo apt-get install wget -y)
* Avoir un accès ssh au serveur

# Les pré-requis hardware conseillés par Sonarqube:
* 2Gb de RAM dédiées à Sonarqube
* L'espace disque dépend de votre projet. Sonarqube.com utilise postgresql 9.5 et utilise 15Gb de stockage.

# Installation

Nous allons installer ce que recommande sonarqube sur sa page (https://docs.sonarqube.org/display/SONAR/Requirements)[https://docs.sonarqube.org/display/SONAR/Requirements].

## Installation d'Oracle JRE 8
Le JRE d'oracle n'est pas disponible dans les dépots Debian pour des raison de licenses.

Mais, WebUpd8 a créer son dépot privé et nous le fourni gratuitement.

Ajout du dépot PPA:
```bash
echo "deb http://ppa.launchpad.net/webupd8team/java/ubuntu xenial main" | \
  sudo tee /etc/apt/sources.list.d/webupd8team-java.list
  
echo "deb-src http://ppa.launchpad.net/webupd8team/java/ubuntu xenial main" | \
  sudo tee -a /etc/apt/sources.list.d/webupd8team-java.list
  
sudo apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv-keys EEA14886

sudo apt-get update

sudo apt-get install oracle-java8-installer
```

Oracle vous demande d'accepter sa license. (Autant dire que vous n'avez pas trop le choix :) )

Petit test pour voir que l'installation s'est bien déroulée:
```bash
java -version

# java version "1.8.xyz"                                  
# Java(TM) SE Runtime Environment (xyu)                                
# Java HotSpot(TM) 64-Bit Server VM (xyz) 
```

## Installation d'OpenJDK 8

On ajoute le dépot backport:
```bash
echo "deb http://http.debian.net/debian jessie-backports main" | \
sudo tee /etc/apt/sources.list.d/jessie-backports.list

sudo apt-get update

sudo apt-get install -t jessie-backports openjdk-8-jdk
```

Un petit contrôle que tout est ok entre le JDK et le JRE
```bash
sudo update-java-alternatives --list

# java-1.8.0-openjdk-amd64 1069 /usr/lib/jvm/java-1.8.0-openjdk-amd64 <---- openjdk 1.8 = 8
# java-8-oracle 1081 /usr/lib/jvm/java-8-oracle   <----- JRE 8
```

## Installation de PostgreSQL 9.6

(On peut installer également du OracleDB, MySQL ou MS SQL Server)
J'ai fais ce choix simplement parce que j'ai lu dans la doc que Sonarqube.com utilise postgresql donc je présume que si un bug survient, l'équipe sera instantannément au courant :).

(Oui je sais ils ont surement des environment de test automatisés :) )

C'est parti:
```bash
wget -q https://www.postgresql.org/media/keys/ACCC4CF8.asc -O - | sudo apt-key add -

echo "deb http://apt.postgresql.org/pub/repos/apt/ jessie-pgdg main" | \
sudo tee /etc/apt/sources.list.d/pgdg.list

sudo apt-get update

sudo apt-get install postgresql postgresql-contrib
```

Petit contrôle:
```bash
psql --version

# psql (PostgreSQL) 9.6.3
```

Super on peut passer à la suite :)

## Création d'un user et d'une base de donnée pour SonarQube
