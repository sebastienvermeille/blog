<!DOCTYPE html>
<html>
<head>
   {% assign currentLanguage = 'en' %}
   {% if page.lang[0] %}
   {% assign currentLanguage = page.lang[0] %}
   {% endif %}

   <title>{% if page.title %}{{ page.title }} – {% endif %}{{ site.name }} – {{ site.description[currentLanguage]
      }}</title>

   {% include meta.html %}

   <!-- Compiled and minified CSS -->
   <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.98.2/css/materialize.min.css">

   <!--Import Google Icon Font-->
   <link href="http://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

   <!-- Compiled and minified JavaScript -->
   <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
   <script type="text/javascript" src="assets/js/mixitup.min.js"></script>
   <script type="text/javascript" src="scripts.js"></script>
   <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.98.2/js/materialize.min.js"></script>

   <!--Let browser know website is optimized for mobile-->
   <meta name="viewport" content="width=device-width, initial-scale=1.0"/>

   <!--&lt;!&ndash;[if lt IE 9]>-->
   <!--<script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>-->
   <!--<![endif]&ndash;&gt;-->

   <link rel="stylesheet" type="text/css" href="{{ site.baseurl }}/style.css"/>
   <link rel="alternate" type="application/rss+xml" title="{{ site.name }} - {{ site.description[currentLanguage] }}"
         href="{{ site.baseurl }}/feed.xml"/>

</head>

<body>
<!-- navbar:start -->
<header class="navbar-fixed">
   <nav class="light-blue lighten-1" role="navigation">
      <div class="nav-wrapper container">
         <a id="logo-container" href="{{ site.baseurl }}/" class="brand-logo site-avatar">
            <img src="{{ site.avatar }}"/>

            <!--<div class="site-info">-->
            <!--<h1 class="site-name"><a href="{{ site.baseurl }}/">{{ site.name }}</a></h1>-->
            <!--<p class="site-description">{{ site.description[currentLanguage] }}</p>-->
            <!--</div>-->

         </a>
         {% include navbar-links.html %}
         <a href="#" data-activates="nav-mobile" class="button-collapse"><i class="material-icons">menu</i></a>
      </div>
   </nav>
</header>
<!-- navbar:end -->

<!-- content:start -->
<main class="row">
   <div class="col s12 m12 l12 xl12">
      {{ content }}
      <div class="col s12 m4 l3 xl2">
         <div class="collection with-header">
            <div class="collection-header">
               <h8>Thèmes</h8>
            </div>
            <a href="/howto" class="collection-item">Tous les thèmes</a>

            <!-- Create empty arrays -->
            {% assign tags = '' | split: ',' %}
            {% assign unique_tags = '' | split: ',' %}

            <!-- Map and flatten -->
            {% assign howtos_tags =  site.howtos | map: 'tags' | join: ',' | join: ',' | split: ',' %}

            <!-- Push to tags -->
            {% for tag in howtos_tags '%}
            {% assign tags = tags | push: tag %}
            {% endfor %}

            <!-- Uniq -->
            {% assign tags = tags | sort %}
            {% for tag in tags %}

            <!-- If not equal to previous then it must be unique as sorted -->
            {% unless tag == previous %}

            <!-- Push to unique_tags -->
            {% assign unique_tags = unique_tags | push: tag %}
            {% endunless %}

            {% assign previous = tag %}
            {% endfor %}

            {% for currentTag in unique_tags %}
               {% assign counter = 0 %}
               {% for tag in tags '%}
                  {% if tag == currentTag %}
                      {% assign counter = counter | plus: 1 %}
                  {% endif %}
               {% endfor %}

               <a href="/howto#filter={{ currentTag }}"class="collection-item" data-filter=".filter-{{ currentTag }}">
                  {{ currentTag }}<span class="badge">{{ counter }}</span>
               </a>
            {% endfor %}
         </div>

         {% include adsense.html %}
      </div>
      <div class="col s12 m8 l9 xl10">
         <ul class="grid" id="howtos-container">
            {% for howto in site.howtos | where:"lang", "fr" %}
            <li class="{% for tag in howto.tags %}filter-{{ tag }} {% endfor %}"
                data-tags="{{ howto.tags | jsonify | xml_escape }}">
               <div data-mh="articles"
                    class="card card-medium hoverable card-article">
                  <div data-mh="thumbs" class="card-image">
                     <img src="{{ howto.cover }}" class="responsive-img unselectable">
                  </div>
                  <div class="card-content" style="flex: 1 0 auto;">
                     <p data-mh="articles-title" class="unselectable">{{ howto.title }}</p>
                  </div>
                  <div class="card-action"><a
                          href="{{ site.baseurl }}{{ howto.url }}">Lire</a>
                     <div class="right">
                        {% for tag in howto.tags limit:2 %}
                        <span data-badge-caption="{{ tag }}" class="new badge"></span>
                        {% endfor %}
                     </div>
                  </div>
               </div>
            </li>
            {% endfor %}
         </ul>
      </div>
   </div>
</main>
<!-- content:end -->

<!--<div class="wrapper-masthead">-->
<!--<div class="container">-->
<!--<header class="masthead clearfix">-->
<!--<a href="{{ site.baseurl }}/" class="site-avatar"><img src="{{ site.avatar }}"/></a>-->

<!--<div class="site-info">-->
<!--<h1 class="site-name"><a href="{{ site.baseurl }}/">{{ site.name }}</a></h1>-->
<!--<p class="site-description">{{ site.description[currentLanguage] }}</p>-->
<!--</div>-->

<!--<nav>-->
<!--<a href="{{ site.baseurl }}/">{{ i18n.blog[currentLanguage] }}</a>-->
<!--<a href="{{ site.baseurl }}/about">{{ i18n.about[currentLanguage] }}</a>-->
<!--</nav>-->

<!--<ul>-->
<!--{% assign posts=site.posts | where:"ref", page.ref | sort: 'lang' %}-->
<!--{% for post in posts %}-->
<!--<li>-->
<!--<a href="{{ post.url }}" class="{{ post.lang }}">{{ post.lang }}</a>-->
<!--</li>-->
<!--{% endfor %}-->

<!--{% assign pages=site.pages | where:"ref", page.ref | sort: 'lang' %}-->
<!--{% for page in pages %}-->
<!--<li>-->
<!--<a href="{{ page.url }}" class="{{ page.lang }}">{{ page.lang }}</a>-->
<!--</li>-->
<!--{% endfor %}-->
<!--</ul>-->

<!--</header>-->
<!--</div>-->
<!--</div>-->

<!--<div id="main" role="main" class="container">-->
<!--{{ content }}-->
<!--</div>-->

<!--<div class="wrapper-footer">-->
<!--<div class="container">-->
<!--<footer class="footer">-->
<!--{% include svg-icons.html %}-->
<!--</footer>-->
<!--</div>-->
<!--</div>-->

{% include footer.html %}

{% include analytics.html %}
</body>
</html>
